---
title: "Biodiversity changes are linked to changes in food-web structure and redundancy in riverine ecosystems"
subtitle: "Alain Danet (a,b), Loubna El Madouri (a,c), Andrew P. Beckerman (b),
Maud Mouchet (a), Colin Fontaine (a) and Elisa Thébault (d)"
date: "Research report"
output:
  officedown::rdocx_document:
    number_sections: false
    base_format: "bookdown::word_document2"
always_allow_html: true
number_sections: false
bibliography: references.bib
link-citations: true
#csl: ecology-letters.csl
toc: false
linestretch: 2.0
header-includes:
  - \usepackage[left]{lineno}
  - \linenumbers
  - \usepackage{hyperref}
  - \hypersetup{backref=true}
  - \usepackage{setspace}\doublespacing
csl: pnas.csl
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  cache = FALSE,
  collapse = TRUE,
  comment = "#>",
  #fig.dim = c(7, 7),
  fig.fullwidth = TRUE,
  fig.show = "hold",
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  results = TRUE,
  fig.path = "figures/"
)
options(
  knitr.table.format = "latex",
  knitr.graphics.rel_path = FALSE
)
```

```{r, results = FALSE}
library(targets)
library(tidyverse)
library(magrittr)
library(cowplot)
library(viridis)
library(kableExtra)
library(sf)
mypath <- rprojroot::find_package_root_file
source(mypath("R/variable_shortcut.R"))
source(mypath("R/misc.R"))
source_dir(get_mypath("R")) # Define your custom code as a bunch of functions.

mytheme <- theme_cowplot() +
background_grid()

theme_set(mytheme)
```

```{r}
tar_load(full_data2)
nb_st <- unique(full_data2$station) %>% length
nb_op <- nrow(full_data2) %>% round(., -3)

rm(full_data2)
tar_load(glob_tps_trends_decade_no_drivers)
```

- Corresponding author: Alain Danet (a.h.danet@sheffield.ac.uk)

- Author affiliations:

(a) Centre d’Ecologie et des Sciences de la Conservation, UMR 7204 MNHN7
CNRS-Sorbonne Université, Muséum national d’Histoire naturelle de Paris, 43 rue
8 Buffon, 75005 Paris, France

(b) School of Biosciences, Alfred Denny Building, University of Sheffield,
Western Bank, Sheffield S10 2TN, United Kingdom

(c) Laboratoire d’Écologie Fonctionnelle et Environnement, UMR 5245
CNRS-UT3-INPT, Avenue de l’Agrobiopôle, Toulouse, France

(d) Sorbonne Université, CNRS, IRD, INRAE, Université Paris Est Créteil, 15
Institute of Ecology and Environmental Sciences of Paris (iEES-Paris), Paris,
France

- Classification: Biological Sciences (major) - Ecology (minor)

- Keywords: food web structure, biodiversity changes, redundancy, biodiversity &
  ecosystem functioning

# Abstract (152 / 250 words max)

Changes in biodiversity can fundamentally alter ecological communities, yet how
these changes affect food web structure remains poorly understood. Here, we
analyze temporal trends in over 400 riverine fish communities across France
spanning 1995-2018, examining relationships between species richness, community
biomass, and three key metrics of food web structure: connectance, weighted
average trophic level, and trophic pathway redundancy. Using structural equation
modeling, theoretical simulations, and robustness analyses, we demonstrate that declining
community biomass leads to loss of top trophic levels and decreased food web
connectance, while species richness negatively correlates with connectance but
positively affects trophic redundancy. Notably, both biomass and species
richness positively influence the proportion of redundant trophic links,
suggesting that biodiversity loss reduces community robustness to future
perturbations. Our findings, consistent across temporal, spatial, and
theoretical approaches, reveal how biodiversity change restructures food webs
and highlights the utility of food web metrics as indicators of ecosystem
function and fragility.


# Significance (124 / 120 words max)

Understanding how biodiversity loss affects ecological communities is crucial
for predicting and mitigating human impacts on ecosystems. This study
provides comprehensive evidence linking biodiversity changes to food web
structure using an extensive dataset of riverine fish communities. We
demonstrate that changes in community biomass and species richness
systematically alter food web architecture, affecting trophic levels,
connectance, and the redundancy of feeding relationships. Our findings unite
multiple ecological theories, showing how energetic constraints and
biodiversity-ecosystem functioning mechanisms jointly shape food web assembly
and disassembly. Importantly, we show that declining biodiversity reduces the
redundancy of trophic pathways, potentially making communities more vulnerable
to future perturbations. These results suggest that food web structure metrics
could serve as valuable indicators for monitoring ecosystem health and
evaluating conservation strategies.

# Introduction (487 words)

Ecological communities are experiencing massive changes due to human pressures,
which are expected to have striking consequences on ecosystem functioning and
fragility. It is increasingly recognized that such changes across space are
associated with spatial variations in human pressures [@mcgill_fifteen_2015;
@blowes_geography_2019], such as freshwater
and terrestrial biodiversity declines linked to land degradation
[@newbold_global_2015; @cardinale_is_2018; @danet_past_2024], and declining
biomass of marine fishes linked to increased fishing pressures on predatory
fishes [@christensen_century_2014]. These documented changes in diversity and
biomass result in altered community structure and composition
[@dornelas_assemblage_2014; @hillebrand_biodiversity_2018; @danet_past_2024].

The structure of ecological networks, which describe the number, distribution
and strength of interactions among species, is important because it, along with
species richness per se, underpins species coexistence, ecosystem functioning
and the stability of ecological dynamics and ecosystem function
[@chesson_interaction_2008; @thebault_food-web_2003; @oconnor_general_2017;
@danet_species_2021; @eschenbrenner_diversity_2023; @danet_response_2024].
Theory and empirical data have shown that species richness and food-web
structure impact on coexistence [@chesson_interaction_2008], ecosystem
functioning [@thebault_food-web_2003; @wang_biodiversity_2018], stability
[@danet_species_2021; @danet_response_2024; @eschenbrenner_diversity_2023], and
ecosystem robustness to perturbations [@dunne_network_2002;
@allesina_functional_2009; @bodini_using_2009; @allesina_functional_2009].
Keystone predator species regulating dominant competitors can limit competitive
exclusion [@heithaus_predicting_2008; @johnson_rarity_2007;
@estes_trophic_2011], and thereby maintain species richness. Food-webs with
higher trophic levels are linked to elevated  ecosystem productivity
[@thebault_food-web_2003; @wang_biodiversity_2018] and community temporal
stability [@danet_species_2021; @eschenbrenner_diversity_2023;
@danet_response_2024]. Finally, the number and distribution of trophic links in
food-webs determine the robustness of communities to perturbations
[@dunne_network_2002; @allesina_functional_2009; @bodini_using_2009;
@allesina_functional_2009]. A better knowledge of the consequences of
biodiversity change on the structure of ecological networks is thus necessary to
quantify and mitigate anthropogenic driven changes to biodiversity.

There are three key components to the mapping between biodiversity changes and
food-web structure. First, the energetic paradigm underpinning the trophic
theory of biogeography [@lindeman_trophic-dynamic_1942; @gravel_trophic_2011]
posits that the presence of top consumers requires resources in enough numbers
at lower trophic levels derived from bottom up productivity. From this, it can
be further hypothesized that the presence of generalist top consumers will be
strongly conditioned by the amount of community biomass.

Second, connectance (the proportion of realized trophic links), is commonly
reported to decrease as species richness increases [@oconnor_general_2017;
@dunne_network_2006], because consumers are limited in the number of resources
they can consume. Connectance has also been linked to the robustness to species
extinctions [@dunne_network_2002; @allesina_who_2004; @bodini_using_2009]. More
in detail, it is the prevalence of redundant (versus functional) links in food
webs [@allesina_who_2004; @bodini_using_2009; @allesina_functional_2009], i.e.
the redundancy of trophic pathways, that predicts ecosystem robustness as they
can be safely removed without triggering secondary extinctions. We thus predict
that higher species richness covaries with higher redundancy of trophic pathways
in food-webs [@allesina_functional_2009]. Together, these relationships mean
that biodiversity changes are likely to be associated with changes in trophic
links distribution and then possibly to changes in robustness to perturbations,
such as increases in species richness should increase the number of redundant
trophic pathways to top predators and then increase community robustness.

Finally, biodiversity and ecosystem functioning theory suggest specifically that
community biomass should be positively related to species richness
[@loreau_biodiversity_2001]. This arises specifically because of niche
complementarity where species exploit different resources. In the particular
case of food webs, theoretical studies show that the presence of higher trophic
level species decreases niche overlap among producers which then increase
productivity and community biomass [@schneider_animal_2016;
@wang_biodiversity_2018; @wang_intraguild_2019; @nie_will_2023].

Here, we report on an analysis of riverine fish community times series to
document the ecological consequences of biodiversity changes on food web
structure. We specifically aim to reveal the relationship between community
biomass and species richness and three key metrics of food web structure:
connectance, weighted average trophic level, and the proportion of redundant
trophic links (hereafter “redundancy”). To do this, we implemented a sequence of
analyses that allows us to enumerate these relationships as covariation among
temporal trends. First, we estimated `r nb_op` food web structure for `r nb_st`
fish communities with 10+ years of community dynamics spanning 1995-2018 over
France (Fig. \@ref(fig:matmet)a-c, Table S1).  Second, using these food webs, we
estimated the temporal trends in each of species richness, biomass, connectance,
trophic structure and redundancy. Having estimated each temporal trend, we next
constructed an SEM to make specific inference about the relative effects of
community biomass and species richness  temporal trends on the temporal trends
three metrics of food web structure, and the effect of species richness on
community biomass (Fig. \@ref(fig:matmet)d). We also implemented a robustness analysis on the
meta-food web (i.e. the food web grouping all trophic species found in the
dataset and their inferred interactions) to identify species extinction
scenarios that might explain the variation in food web structure that we see in
the timeseries. Finally, we performed three further analysis to evaluate the
robustness and the generality of our results. We replicated our temporal
analysis with a space-for-time approach (Fig. \@ref(fig:matmet)c & e) using median metrics in
each site instead of the temporal trends; we created a simulation of complex
communities using a bioenergetic food web model to assess the generality of our
results in complex communities that allow relaxation of some of the constraints
defined by our fish biodiversity data; and we performed a three-scenario,
topological secondary extinction analysis on the full empirical metaweb to
evaluate the role of top predators on food-web structure.

```{r}
fig_mat_cap <- paste0("Using ", nb_st," sites of stream fishes in (a) French streams that
  have been monitored at least 10 years, (b) we reconstructed the food-web at each
  site and each sampling event by building a metaweb based on ontogenic food diet information for each
  species and predator-prey body size ratio. (c) We computed the temporal trends
  and the median of community biomass, species richness, connectance, average
  trophic level, and redundancy at each site. We then assessed the relationships
  among food web structure descriptors, (d) in time and (e) across
  space. We additionally performed extinction simulations from the metaweb and
  insilico experiments using a bioenergetic food web model to gain more insights
  and assess the generality of our results (see Methods).")
```

```{r matmet, fig.cap=fig_mat_cap, out.width="100%"}
knitr::include_graphics(get_mypath("figures", "mat_met.png"))
```

# Results

```{r, results=FALSE}
gbm <- get_effect_ci(resp = "log_bm_std", ci_lvl = "level:0.80", p = TRUE)
gr <- get_effect_ci(resp = "log_rich_std", ci_lvl = "level:0.80", p = TRUE)
gt <- get_effect_ci(resp = "w_trph_lvl_avg", ci_lvl = "level:0.80", p = FALSE)
gct <- get_effect_ci(resp = "connectance", ci_lvl = "level:0.80", p = FALSE)
gl <- get_effect_ci(resp = "prop_redundant_links", ci_lvl = "level:0.80", p = FALSE)
```

```{r}
tar_load(c(r2_inla_tab, r2_inla, r2_sem))
r2_inla_report <- r2_inla %>%
  select(response, r2_mvp_marg95hpdci, r2_mvp_cond95hpdci, r2_mvp_cond_mean)
r2cond <- map(
  setNames(r2_inla_report$response, r2_inla_report$response),
  ~round(r2_inla_report[r2_inla_report$response == .x, ]$r2_mvp_cond_mean, 2)
)
r2ic <- map(
  setNames(r2_inla_report$response, r2_inla_report$response),
  ~r2_inla_report[r2_inla_report$response == .x, ]$r2_mvp_cond95hpdci
)
```

```{r}
tar_load(summary_pred_station_tps10)
dfv <- function(
  x = summary_pred_station_tps10,
  r = "connectance",
  v = "min",
  d = 4
) {
  out <- x[x$response == r, ][[v]]
  format(round(out, d), nsmall = d)
}
grbmn <- dfv(r = "log_bm_std", v = "min", d = 0)
grbmx <- dfv(r = "log_bm_std", v = "max", d = 0)
grrhn <- dfv(r = "log_rich_std", v = "min", d = 0)
grrhx <- dfv(r = "log_rich_std", v = "max", d = 0)
grctn <- dfv(r = "connectance", v = "min", d = 2)
grctx <- dfv(r = "connectance", v = "max", d = 2)
grtln <- dfv(r = "w_trph_lvl_avg", v = "min", d = 2)
grtlx <- dfv(r = "w_trph_lvl_avg", v = "max", d = 2)
grln <- dfv(r = "prop_redundant_links", v = "min", d = 2)
grlx <- dfv(r = "prop_redundant_links", v = "max", d = 2)
```

## Estimating temporal trends

Our food web reconstruction delivered `r nb_op` estimates of species richness,
biomass, connectance, weighted average trophic level, and the proportion of
redundant trophic links (hereafter "redundancy", see Appendix B) from our 403
fish communities with 10+ years of population dynamics spanning 1995-2018 over
France (Fig. 1a-c). We implemented Bayesian hierarchical models to jointly
estimate the temporal trends in these metrics. We found a great heterogeneity in
the temporal trends at the site level (community biomass: from `r grbmn`% to
`r grbmx`% per decade, species richness: `r grrhn` to +`r grrhx`%, average
trophic level: `r grtln` to +`r grtlx`, connectance: `r grctn` to +`r grctx`,
redundancy: `r grln` to +`r grlx`, Fig. S1) which was effectively captured by
the hierarchical model (with conditional R2 between `r r2cond$log_bm_std` for
community biomass to `r r2cond$log_rich_std` for species richness, Table S2).



```{r}
sem_cap <- "(a) Structural equation models linking the temporal trends of the
food-web structure. The path widths are proportional to the standardized slope
coefficients. The standardized slope coefficients and their associated 95%
  confidence intervals obtained by bootstrapping are displayed along the path.
R2 displays the marginal R-squared of the linear models. (b to h) Direct
bivariate relationships derived from the structural equation model. Points
display the temporal trends at each site estimated with a hierarchical Bayesian
model, lines display the linear relationship estimated with the SEM. The
distribution of the site temporal trends are displayed in Fig. S1. All the
effects are reported in Table S3. Average trophic level is weighted by the
biomass of the trophic species. Redundancy is the proportion of redundant
links."
```

```{r sem, fig.cap = sem_cap, out.width = "100%"}
tar_load(p_sem_tps_file)
knitr::include_graphics(p_sem_tps_file)
```

```{r}
tar_load(c(semeff_tot, semeff_tot_ok))
semeff_tot <- semeff_tot %>%
  mutate(across(c(response, predictor), ~str_remove(.x, "mean_")))

rdtps <- map(
  setNames(
    c("connectance", "w_trph_lvl_avg", "log_bm_std", "prop_redundant_links"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    bm = get_semeff_ci(resp = .x, term = "log_bm_std"),
    r = get_semeff_ci(resp = .x, term = "log_rich_std")
    )
)
rdsp <- map(
  setNames(
    c("connectance", "w_trph_lvl_avg", "log_bm_std", "prop_redundant_links"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    bm = get_semeff_ci(resp = .x, term = "log_bm_std", model = "spatial"),
    r = get_semeff_ci(resp = .x, term = "log_rich_std", model = "spatial")
    )
)
rdm <- map(
  setNames(
    c("Connectance", "Avg trophic level", "Biomass", "Redundancy"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    bm = get_semeff_ci(x = semeff_tot_ok, type = "Direct", resp = .x, term = "Biomass", model = "Theoretical model"),
    r = get_semeff_ci(x = semeff_tot_ok, type = "Direct", resp = .x, term = "Species richness", model = "Theoretical model")
    )
)
```

```{r}
ridtps <- map(
  setNames(
    c("connectance", "w_trph_lvl_avg", "log_bm_std", "prop_redundant_links"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    r = get_semeff_ci(resp = .x, term = "log_rich_std", type = "indirect")
    )
)
ridsp <- map(
  setNames(
    c("connectance", "w_trph_lvl_avg", "log_bm_std", "prop_redundant_links"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    r = get_semeff_ci(resp = .x, term = "log_rich_std",
      model = "spatial", type = "indirect")
    )
)
ridm <- map(
  setNames(
    c("Connectance", "Avg trophic level", "Biomass", "Redundancy"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    bm = get_semeff_ci(x = semeff_tot_ok, type = "Indirect", resp = .x, term = "Biomass", model = "Theoretical model"),
    r = get_semeff_ci(x = semeff_tot_ok, type = "Indirect", resp = .x, term = "Species richness", model = "Theoretical model")
    )
)
rttps <- map(
  setNames(
    c("connectance", "w_trph_lvl_avg", "log_bm_std", "prop_redundant_links"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    bm = get_semeff_ci(resp = .x, term = "log_bm_std", type = "total"),
    r = get_semeff_ci(resp = .x, term = "log_rich_std", type = "total")
    )
)
rtsp <- map(
  setNames(
    c("connectance", "w_trph_lvl_avg", "log_bm_std", "prop_redundant_links"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    bm = get_semeff_ci(resp = .x, term = "log_bm_std",
      model = "spatial", type = "total"),
    r = get_semeff_ci(resp = .x, term = "log_rich_std",
      model = "spatial", type = "total")
    )
)
rtm <- map(
  setNames(
    c("Connectance", "Avg trophic level", "Biomass", "Redundancy"),
    c("ct", "tlvl", "bm", "red")
    ),
  ~ list(
    bm = get_semeff_ci(x = semeff_tot_ok, type = "Total", resp = .x, term = "Biomass", model = "Theoretical model"),
    r = get_semeff_ci(x = semeff_tot_ok, type = "Total", resp = .x, term = "Species richness", model = "Theoretical model")
    )
)
```

## Association between biodiversity and food-web temporal trends

These temporal trend estimations at the site level were the input to our SEM,
allowing us to evaluate the direct and indirect effect of species richness and
community biomass changes on food web structure changes and between species
richness and community biomass. We detected a strong positive association
between community biomass and in species richness ($r_\delta =$ `r rdtps$bm$r`,
Fig. \@ref(fig:sem) a and b, $r_\delta$: standardized slope coefficient, [95%
CI], Table S3). This indicates that communities with decreasing species richness
over time experienced a concomitant decrease in community biomass and
vice-versa.

Our SEM also predicts a positive effect of community biomass on connectance,
average trophic level, and redundancy (resp. $r_\delta =$ `r rdtps$ct$bm`,
`r rdtps$tlvl$bm`, `r rdtps$red$bm`, Fig. \@ref(fig:sem)b, c, d). Thus, when communities
experienced a decrease in biomass, they also experimented a concomitant decrease
in connectance, average trophic level and redundancy, and vice versa. We further
found that the temporal trends in community biomass were positively associated
with both the number and the proportion of piscivorous species (Fig. S2a),
suggesting that the presence of high trophic level trophic species has a
disproportionate role community biomass.

The effects of species richness were more complex, because species richness in
this model has indirect effects on food-web structure through community biomass.
Species richness had a direct negative effect on connectance ($r_\delta =$
`r rdtps$ct$r`, Fig. \@ref(fig:sem)f), a positive indirect effect through
community biomass ($r_\delta =$ `r ridtps$ct$r`), so that species richness had a
negative effect in total on connectance ($r_\delta =$ `r rttps$ct$r`, Fig.
\@ref(fig:std)a). In contrast, species richness had no direct effects on in
average trophic level ($r_\delta =$ `r rdtps$tlvl$r`, Fig. \@ref(fig:sem)g), a
positive indirect effect through community biomass ($r_\delta =$
`r ridtps$tlvl$r`), which adds up to a positive total effect of species richness
temporal trends on average trophic level ($r_\delta =$ `r rttps$tlvl$r`, Fig.
\@ref(fig:std)a). Species richness temporal trends had direct and indirect
positive effect on the temporal trends in redundancy (resp. $r_\delta =$
`r rdtps$red$r`, `r ridtps$red$r`), which added up to a strong positive effect
($r_\delta =$ `r rttps$red$r`).

Furthermore, we found that temporal trends of the proportion of piscivorous
species was negatively associated with the temporal trends of species richness
(Fig. S2), meaning that communities that increase in richness over time have an
increase in the proportion of non-piscivorous species over time and vice versa.
It means food-webs that have experienced declines in species richness over the
last decades have decreased in average trophic level and redundancy but increase
in connectance, and conversely, those that experienced increases in species
richness have increased in average trophic level, redundancy, but decreased in
connectance.

## Theoretical simulations and space-for-time analysis (mostly) agree with the temporal analysis

We further assessed the consistency of the reported associations among temporal
trends by implementing two additional analyses. We first tested if the
associations among the temporal trends within sites was holding across sites,
i.e. using spatial variations in food-web structure rather than temporal changes
over time (space-for-time hypothesis). Second, we performed theoretical
simulations with a bioenergetic food-web model to cross-reference our site and
species specific empirical data on riverine fish with a more generalized
representation of food web dynamics known to represent accurate relationships
among our focal variables [@brose_allometric_2006; @eschenbrenner_diversity_2023;
@danet_response_2024]. With those additional empirical and theoretical data, we
assessed additional SEM models with the same structure as in Section 4.2.

As in the temporal analysis, species richness had a positive effect on community
biomass both in empirical data and in theoretical simulations (resp. $r_\delta
=$ `r rdsp$bm$r` and `r rdm$bm$r`, Fig. \@ref(fig:std)a and S3). In both
empirical data and theoretical simulations, community biomass had a positive
effect on average trophic level (resp. $r_\delta =$ `r rdsp$tlvl$bm` and
`r rdm$tlvl$bm`), and redundancy (resp. $r_\delta =$ `r rdsp$red$bm` and
`r rdm$red$bm`), as in temporal analysis. We found weak evidence of a positive
effect of spatial variation in community biomass on connectance in empirical
data ($r_\delta =$ `r rdsp$ct$bm`) but strong evidence in theoretical
simulations ($r_\delta =$ `r rdm$ct$bm`, Fig. \@ref(fig:std)a).

The effects of spatial variations in species richness on food-web structure
mostly aligned with those from the temporal trend analysis, except for average
trophic level. We found a direct negative effect of species richness on
connectance both using data and model simulations (resp. $r_\delta =$
`r rdsp$ct$r` and `r rdm$ct$r`, Fig. \@ref(fig:std)a), on average trophic level
(resp. $r_\delta =$ `r rdsp$tlvl$r` and `r rdm$tlvl$r`), but a direct positive
effect on redundancy (resp. $r_\delta =$ `r rdsp$red$r` and `r rdm$red$r`).
Species richness had an indirect positive effect of species richness through
community biomass, which added up to strong total negative effects on
connectance in empirical data and simulations (resp. $r_\delta =$
`r rtsp$ct$r` and `r rtm$ct$r`) and positive on redundancy (resp. $r_\delta =$
`r rtsp$red$r` and `r rtm$red$r`). We found that
species richness had a total positive effect on average trophic level in
bioenergetic model, in agreement with temporal trends (resp. $r_\delta =$ `r rtm$tlvl$r`),
but a total negative effect in spatial variations (resp. $r_\delta =$ `r rtsp$tlvl$r`).

## Robustness of food web structure to species extinctions

We implemented three secondary extinction simulation scenarios on the empirical
metaweb defined as a food-web containing all the trophic species found across
all sites in the empirical data. This was to access a second line of inference
about whether top species were drivers of biomass and structure patterns (see
section 4.2). When species are removed in a sequential order beginning by the
highest trophic levels, connectance, average trophic level, and redundancy
decreased (purple lines, Fig. \@ref(fig:std)b). On the other hand, removing low trophic level
species first increases connectance and average trophic level, but do not affect
redundancy (yellow lines, Fig. \@ref(fig:std)b). In turn, random species extinction sequence
had little effect on food-web structure (black line, Fig. \@ref(fig:std)b). These results, in
tandem with our empirical analyses above, suggest that top consumers play a
disproportionate role in driving the changes in food web structure that we
report.


```{r}
std_cap <- paste0( "a, Direct and total effects of community biomass and species
  richness trends on food-web structure trends. Standardized coefficients (r)
  derived from the temporal, spatial, and bioenergetic model Structural Equation
  Models. Points and lines display the estimated effects and their confidence
  intervals at 95\\%. Values are displayed in Table S3, R-squared in Table S4, and
  the visualization of the bivariate relationships for the spatial and
  bioenergetic model SEMs are displayed in Figure S3. Average trophic level is
  weighted by the biomass of the trophic species. Redundancy is the proportion
  of redundant links. b, Effect of species extinctions on the structure of the
  empirical metaweb according to three scenarios. In the Decreasing and
  Increasing scenarios, species were ordered by their trophic level and removed
  from the metaweb starting respectively from the highest and lowest trophic
  level. Species were removed in a random sequence (50 sequences, grey dots) for
  the random scenario, the black line displaying the average predicted by a GAM
  linear model. For the extinction sequence, the average trophic level was not
  weighted by the biomass of species as this information is not available at the
  metaweb scale. Similar results were obtained with trophic species (i.e. node)
  extinction (Fig. S4).")
```

```{r std, fig.cap=std_cap, out.width = "100%"}
tar_load(p_sem_tot_ext_sp_file)
knitr::include_graphics(p_sem_tot_ext_sp_file[[1]])
```


# Discussion


We found remarkable variability in the estimated temporal trends in biomass,
species richness and three metrics of food web structure in riverine fish
communities across more than 400 locations throughout France. Those contrasted
situations were instrumental to evaluation the association between biodiversity
temporal changes and food-web structure temporal changes.

Via a combination of SEM modelling, simulations and more specific assessment of
robustness to identify guild/tropho-species drivers, we found, across temporal,
space-for-time and simulations that (1) average trophic level is consistently
positively related to changes in total biomass; (2) connectance is consistently
negatively related to changes in species richness; and (3) redundancy covaries
positively with community biomass and species richness. We also found (4) a
weak relationship between species richness and average trophic level that varied
by temporal versus space-for-time approaches. Additionally (5) we found evidence
for a significant role of top predator species in driving these patterns. Here
we discuss these patterns and their implications in more depth.

We found that species richness scaled positively with community biomass.  Our
result was consistent across our temporal, spatial and theoretical simulations
and is in-line with previous analysis across space in stream communities
[@woods_testing_2020; @danet_species_2021] and in grasslands, salt marshes and
forests [@hector_plant_1999; @tilman_biodiversity_2014; @wu_relationship_2015;
@li_relationship_2018; but see @grace_integrative_2016].   These empirical data
collectively align with theory showing that food-web diversity can increase
biomass by stimulating primary production and resource uptake
[@schneider_animal_2016; @wang_biodiversity_2018; @wang_intraguild_2019;
@nie_will_2023] and Biodiversity-Ecosystem Functioning theory where the loss of
species richness and biomass predicts impaired ecosystem functioning
[@loreau_biodiversity_2001]. These data and theory firmly indicate that loss of
biodiversity per se (e.g. species richness) can lead to overall loss of biomass
in many ecosystems and mitigating actions that increase biodiversity can lead to
an increase in community biomass.

Our results also show that food-webs that have undergone a biomass decline
experienced significant structural changes marked by a loss of top trophic
levels species and a decreased connectance. These results can be linked with the
energetic and trophic biogeography theories [@lindeman_trophic-dynamic_1942;
@gravel_trophic_2011], which posit that the presence of high trophic level
species is limited by the productivity and the amount of energy available
[@lindeman_trophic-dynamic_1942, @takimoto_ecosystem_2008; @post_ecosystem_2000;
@post_long_2002]. Thus, our results suggest a decrease in community biomass can
limit the amount of resource available to sustain high trophic level species,
while increase in community biomass may translate in more resources available
for high trophic level species [@takimoto_ecosystem_2008; @post_ecosystem_2000].

Biodiversity-Ecosystem Functioning theory offers an alternative causal
explanation, indeed the presence of higher trophic level species can decrease
niche overlap among producers and then increase productivity and community
biomass [@schneider_animal_2016; @wang_biodiversity_2018; @wang_intraguild_2019;
@nie_will_2023]. The positive association of connectance with community biomass
was weaker than for average trophic level, which might be related to the
contrasting effects of connectance, negative or positive, on productivity
previously reported in theoretical models [@nie_will_2023;
@wang_intraguild_2019; @thebault_food-web_2003; @poisot_trophic_2013;
@schneider_animal_2016]. While increasing connectance between herbivores and
plants has been reported to either increase or decrease productivity
[@thebault_food-web_2003; @poisot_trophic_2013; @nie_will_2023], increasing
connectance within carnivores having generally a positive effect on productivity
because higher connectance can decrease top-down control and allow biomass to
accumulate across trophic level [@wang_intraguild_2019; @schneider_animal_2016].

Species richness was negatively associated with connectance, confirming previous
results [@dunne_network_2006], and was suggested to be the results of
limitations of predator generality [@dunne_network_2006]. The effects of species
richness changes on the average trophic level were more contrasted and twice
lower in strength than the effects of community biomass. The direct effect of
species richness on average trophic level being null, or negative considering
temporal or spatial and theoretical models. When accounting for the indirect
effect of species richness on community biomass, temporal and theoretical
analysis indicates changes in species richness are positively associated with
changes in average trophic level. Those contrasted effects of species richness
on average trophic level can be related to the results of our extinction
simulations where the removal of top trophic level species had much less impact
on average trophic level than on connectance and redundancy. This discrepancy in
space and time is likely due to the strong assumption that variations in space
reflect differences in assembly stages of ecological communities and then mirror
their temporal assembly/disassembly trajectories. Spatial gradients reflect
aggregated dynamics over a longer timescale including a far number of
processes including high species turnover and differences in ecosystem
productivity along spatial gradients that are not captured by species richness
[@post_ecosystem_2000; @post_long_2002].

Altogether, our results then suggest community biomass changes in space might be
a good surrogate to infer assembly and disassembly of food-webs in time, but
that it is probably not always the case for species richness. Furthermore, it
suggests that species richness increase and decrease were less clearly linked to
specific changes in top trophic levels than community biomass. Species richness
temporal trends could be more linked to changes in the redundancy of trophic
roles in the food-webs, such as it has little effect on food-web structure
itself but increases its community biomass. This interpretation aligns with the
insurance hypothesis [@yachi_biodiversity_1999; @loreau_biodiversity_2021], such
as species richness and associated redundancy in species roles can increase
ecosystem stability by buffering the impacts of perturbations
[@sanders_trophic_2018].

Our study also demonstrates that redundancy of trophic pathways in food-webs are
positively associated to both community biomass and species richness changes, so
as declines in community biomass and species richness triggers a loss in the
proportion of redundant links in food-webs, while increases in community biomass
and species richness over time results in the increase in the proportion of
redundant links in food-webs. Redundant links are the trophic links that can be
removed with triggering secondary extinctions [@allesina_who_2004;
@bodini_using_2009], such a higher proportion of redundant interactions increase
robustness of food-webs to perturbations [@allesina_functional_2009]. It
suggests that declines in community biomass and species richness result in a
decline of food-web robustness to further perturbations. The positive link
between redundancy and biomass is consistent to previous theoretical results
showing that higher redundancy in trophic pathways could be associated with a
decrease in complementarity within trophic species which in turn can reduce
top-down effects and stimulate biomass productions [@wang_biodiversity_2018;
@wang_intraguild_2019], and also give opportunity for compensatory dynamics
which in turn increase robustness following extinctions
[@staniczenko_structural_2010].

We aimed to expose the relationships among three metrics of food web structure,
community biomass and species richness. Our results, derived from a larger and
extensive temporal and spatially resolved dataset, align with multiple bodies of
theory and deliver consistent results across multiple methodologies. In an era
of rapid anthropogenic driven change impacting directly the biodiversity of
communities, these relationships are vital to our capacity to predict and
mitigate effects. For example, our results suggest that community biomass
changes are associated with changes in the presence and biomass of top
predators, in agreement with two bodies of theory. Energetic theory which
assumes that food-web maximum trophic level are mainly limited by the amount of
energy available in lower trophic levels and Biodiversity-Ecosystem Functioning
theory which assumes that the presence of higher trophic levels is the cause of
higher productivity and total biomass. In contrast, species richness changes
seem to be linked to changes in the upper and lower part of the food-webs.
Importantly, temporal and spatial analysis using empirical fish food-webs are
largely in agreement with theoretical simulations, which highlight the potential
generality of the food-web assembly rules that we report. The study finally
highlights that increases in community biomass and species richness brings
robustness to food-webs by increasing the proportion of redundant trophic links.
Altogether, our results suggest that assessments of food-web structure,
community biomass and richness, which may be more feasible than direct
estimation of function, may deliver much needed indicators of functional decline
and metrics thus for the efficacy of mitigation strategies.


# Material & Methods

We used a monitoring of freshwater fishes conducted all over France and
conducted by the Office Français de la Biodiversité (OFB). The sampling
protocols were standardized since 1995 and a complete description of the
sampling process can be found in @danet_species_2021. The fishes are sampled
using electrofishing all across the streams in shallow streams and over the bank
by boat in deeper streams. All the fishes are counted and the bodysize of fishes
are recorded for a sample of them, enabling the estimate the distribution of
individual bodysize by species for each sampling [@bonnaffe_comparison_2021;
@danet_species_2021].

We selected the sites that have been monitored at least 10 years on the
1995-2018 period, with the same sampling protocol over time. We selected
one sampling a year by site. In each site, we ensured low temporal heterogeneity
in sampling period by selecting sampling that were performed in the same period,
leading to a mean standard deviation of sampled month in each site of three
weeks [@danet_species_2021]. Those steps lead to the selection of
`r nb_st` sites (Fig. \@ref(fig:matmet), Table S1).

## Biomass

We first inferred the body mass of each fish individual considering an allometric
law, $B_i = 0.01 \times l_i^{3.03}$, $B_i$ being the biomass expressed in gram and $l_i$ the
body length of the individual $i$ expressed in millimeters [@froese_cube_2006]. Then the
biomass of each species and community biomass were obtained by summing the body
mass of individuals. Finally, the biomass was reported to the sampled surface
(in $m^2$) to account for sampling effort.

## Food-web inference

We inferred food-web structure in two steps [@bonnaffe_comparison_2021;
@danet_species_2021]: (1) we first computed the metaweb, describing the
potential trophic interactions among all size classes species, (2) then we
extracted each yearly snapshot of food-webs by extracting species size classes
and their interactions according to their presence in a given sampling event.

We inferred the metaweb according to ontogenic diet data and body size
[@gravel_inferring_2013; @@poisot_trophic_2013; @brose_predator_2019;
@bonnaffe_comparison_2021; @danet_species_2021]. The method is extensively
described in @bonnaffe_comparison_2021 and @danet_species_2021. The food diet of
stream fishes changes along their life cycle or stage, therefore according to
their body size. Each fish species was divided in nine size classes, named
"trophic species", equally distributed in their observed body size range. Thus,
a trophic species is a group of individuals of the same species and size class
that are expected to share the same preys and predators because trophic
interactions are largely determined by predator-prey size ratio
[@brose_allometric_2006]. We also added seven nodes present in the ontogenic
food diet database: detritus, biofilm, phytoplankton, zooplankton, macrophages,
phytobenthos and zoobenthos.  The resulting metaweb contained 45 fish species
divided into nine size classes plus 7 resource nodes, summing up to 412 nodes.
Consideration of size classes, i.e.  trophic species instead of species,
improves inference of trophic interactions [@jennings_weak_2001].

We determined the feeding interactions of trophic species according to their
species identity and their body size. The diet database described two or three
life stages by fish species, each one being delimited by body size. The
ontogenic fish diet database was filled according to fishbase
[@froese_fishbase_2021] and literature [@bonnaffe_comparison_2021;
@danet_species_2021].

The feeding interactions among fishes were based on the body size ratio
between predators and preys. We defined the predation window of a
piscivorous trophic species as 3% to 45% of its midpoint
[@mittelbach_ontogeny_1998; @claessen_impact_2002; @hart_handbook_2008].  A
trophic link was defined between the piscivorous trophic species and all the
trophic species whose midpoint in body size range was included in the predation
window.  The fish-resource trophic links were set between the trophic species
and the resources nodes according to the food items of their size class.
Finally, the feeding interactions between resources were defined according to the
literature [@allan_stream_2007; @hart_handbook_2008].

## Community and food-web structure

At each site, yearly food-webs were described by their community biomass and
species richness. Yearly food-web structure was described by their connectance,
describing the degree of generalism in a network [@dunne_network_2006;
@delmas_analysing_2019]. It was computed as the ratio between the number of
actual links and the number of potential links ($C = \frac{L}{S(S-1)}$, with $L$
being the number of links and $S$ the number of trophic species). We also
computed the average trophic level, weighted by the biomass of the trophic
species. The trophic level of a trophic species was computed recursively as 1
added to the mean trophic level of the preys that it consumes
[@herendeen_ecological_2008]. We computed the number of redundant and functional
links using the dominator tree approach [@allesina_functional_2009]. A species
$i$ is a dominator of species $j$ if $i$ mediates the connection $j$ to basal
resources such as the extinction of $i$ remove the connection of $j$ to basal
resources. It is then to identify the set of trophic links that are essential to
connect species to basal resources, i.e. functional links, and the
redundant links. This method requires a single basal root in the food-webs. To
do so, we added a basal dummy resource node to the empirical food-webs connected
to biofilm and phytoplankton resource node. For food-webs generated from
theoretical simulations (see below), we added a resource node connected to all
primary producers. We computed the set of dominator trees using the
`dominator_tree()` function in `igraph` R package. We computed the number of
functional links as the number of links in the resulting dominator tree of the
food-web. We checked that the procedure reproduced the examples presented in
@allesina_functional_2009. We then derived the proportion of redundant links in
food-webs of empirical and theoretical simulations.


## Temporal trends of food-web

We modeled the temporal trends of food-web structure at each site ($Y_i$) using
linear hierarchical model. Time was considered as the number of year since the
first sampling ($t = 0$) at each site. We accounted for the spatial structure of
the data by adding random intercepts ($a$) and slopes ($b$) for the
basin ($a_n$, $b_n$) and site ($a_{i|n}$, $b_{i|n}$) identity, site effects
being nested in the basin one.

$$
\begin{aligned}
    Y_{i|n, t} &= \alpha + \beta Time_t + \epsilon_{i|n, t}
  (\#eq:gen)
\end{aligned}
$$

- $\alpha = \alpha_0 + a_n + a_{i|n}$
- $\beta = \mu + b_n + b_{i|n}$
- $a_n, a_{i|n}, b_n, b_{i|n}, \epsilon_{i|n, t} \sim \mathcal{N}(0,\,\sigma^{2})$
- $n$: basin, $i$: site $i$, $t$: time $t$

The model parameters were estimated using INLA (Integrated Nested Laplacian
Approximation) Bayesian inference with default uninformative priors
[@rue_bayesian_2017]. The prior distributions for the fixed intercept and slope were
modeled as a flat normal distribution with a mean of zero ($\mathcal{N}(0,\, 1000)$).
Prior distributions for the Gaussian error $\epsilon_{i|n, t}$ and the random
effects were modeled as a log gamma distribution with
shape and inverse scale parameters ($\mathcal{G}(s, \, \tau) = \mathcal{G}(1, \,
5.10^-5)$), then their respective standard deviation were obtained by
backtransforming the inverse scale parameter ($\sigma = 1 / \sqrt{\tau}$).
Community biomass and species richness were logged transformed.

The performance of the model was assessed visually by plotting the fitted versus
the observed values (Fig. S5). We also visually inspected the Posterior
Integral Transform (PIT) and Conditional Predictive Ordinate (CPO) to assess the
quality of the model fit. We also computed the marginal ($R^2_m$)and conditional
($R^2_c$) R-squared of the models following previous formulations
[@nakagawa_general_2013; @lahuis_explained_2014]. In order to account for the
variability associated with the priors [@gelman_r-squared_2019], we computed the
variance of the posterior distribution  of each predicted values ($Var_{fit} =
\sigma^2(\hat{Y_i})$). We computed $R^2$ values for each predicted values, then
obtaining a $R^2$ distribution [@gelman_r-squared_2019]. We reported mean
marginal and conditional $R^2$ associated the 95% credible interval computed
using the Highest Posterior Density method.

$$
R^2_m = \dfrac{Var_{fit}}{Var_{fit} + Var_{res}} = \dfrac{\sigma^2(\hat{Y_i})}{\sigma^2(\hat{Y_i}) + \sigma^2(Y_i - \hat{Y_i})}
$$

$$
R^2_c = \dfrac{Var_{fit} + (a_n)^2 + (a_{i|n})^2}{Var_{fit}  + (a_n)^2 + (a_{i|n})^2 + Var_{res}}
$$

$y_i$ and $\hat{y_i}$ being respectively the observations and the
predicted values, $Var_{fit}$ and $Var_{res}$ being respectively the variance of
predictive means and the variance of the residuals. $a_n$ and $a_{i|n}$ are
respectively the standard deviation on the random intercept associated to the
basin and the site.

We extracted the temporal trends at each site from the hierarchical model
using mean BLUP values (Best Linear Unbiaised Prediction), then multiplied
by 10 to get temporal trends by decade. For logged transformed biomass and
species richness, we derived percentage change by decade by transforming the
slopes ($\beta\prime = (e^{\beta } - 1) \times 100 \times 10$).

Overall, we found that standard deviation attributed to site effects in both
baseline and temporal trends in community structure were much higher than the
ones found for hydrographic basin (Table S5).

## Spatial

We assessed the validity of the space-for-time substitution hypothesis by
comparing the relationships estimated among food-web structure in time to the
ones inferred in space. We used the same sites as in the temporal analysis,
but we summarized temporal series of each station by the median value over time
of each facet of food-web structure described above (Fig. \@ref(fig:matmet)).

## Statistical analysis

We modeled the relationships among food-web structure, that is connectance,
average trophic level, the proportion of redundant trophic links, and community
biomass ($dB$) and species richness ($dR$) with Structural Equation Models. We
modeled species richness as related to community biomass and food-web structure.
In turn community biomass was related to food-web structure. We computed one
structural equation model to assess the relationships among the temporal trends
and one for the relationships over the spatial gradient, we added a random
effect of the hydrographic basin on the intercept for the latter one.

In order to control for the uncertainties of the estimated temporal trends, we
weighted each temporal trend by the inverse of the sum of the standard deviation
of the estimated trends, i.e. the estimated slopes for the response and the
explicative variables ($w_j = 1 / \sum{e_j}$, $w_j$ being the weight, and
$s_{e_j}$ the standard deviation on the temporal trends of the variables).

The coefficients of the Structural Equation Models were computed with
PiecewiseSEM R package [@lefcheck_piecewisesem_2016]. The coefficients were
standardized and the confidence intervals were computed with semEff R package
[@murphy_semeff_2021]. Confidence intervals were obtained by bootstrapping the
linear models 1000 times and computing adjusted bootstrap percentile interval
(BCa), which are adjusted for the asymmetric distribution of resampling. The marginal
and conditional $R^2$ associated to the linear models of the SEMs were computed
with the Nagelkerke method [@lefcheck_piecewisesem_2016, Table S4].

All the statistical models displayed low multicollinearity (Variance inflation
factors < 3, Table S6). We visually inspected the residuals of the linear
models.



## Extinction simulation in the metaweb

We simulated extinction sequences in the metaweb according to three scenarios to
get expectations on how the food-web structure should change according to the
addition and deletion of species and nodes. The scenario of extinction sequences
were related to the trophic level of the species/nodes. In the decreasing and
increasing scenario, we removed species/nodes in decreasing, resp. increasing
order, of their trophic level, i.e. respectively beginning by the highest and
lowest trophic level. In the random extinction sequence, we built 50 random
extinction sequences. For each simulation, we removed fish species/nodes that
lost all their preys. We then computed the connectance, the average and the
maximum trophic level after each extinction.

## Theoretical simulations

```{r}
tar_load(sim_param)
nsim <- nrow(sim_param)
nfw <- length(unique(sim_param$fw_id))
s_range <- c(min = min(sim_param$S), max = max(sim_param$S))
c_range <- c(min = min(sim_param$C), max = max(sim_param$C))
k_range <- c(min = min(sim_param$K), max = max(sim_param$K))
```


We used a bioenergetic food-web model to simulate the effects of community
biomass and species richness changes on food-web structure. This food-web model
lifts one of the limitation of our data, that is it includes the biomass of all
the food-webs from primary producers to top predators. This model allows
simulating complex communities because its parameterization depends mainly on
species bodymasses. We first generated `r nfw` food-webs varying in species
richness (range: `r s_range["min"]`-`r s_range["max"]`)
and connectance (range: `r c_range["min"]`-`r c_range["max"]`) using the niche
model algorithm, which reproduces food-web topology typically found in empirical
food-webs [@williams_simple_2000]. We set species bodymasses ($M_i$) using a predator-prey
mass ratio of 100 ($Z$) [@brose_allometric_2006; @brose_predator_2019], such as $M_i =
Z^{(TL_i - 1)}$, $TL_i$ being the trophic level of the species $i$. The
metabolic rates of the species ($x_i$) were then derived from allometric
relationships between metabolism and bodymass empirically estimated
[@brose_allometric_2006], such as $x_i = -0.314M_i^{-0.25}$.

The dynamics of species biomasses are described by an ODE systems of two
equations, for primary producers (eq. \@ref(eq:prod)) and consumers (eq.
\@ref(eq:cons)) respectively:

\begin{equation}
    (\#eq:prod)
	\frac{dB_i}{dt} =
    r_i B_i G_i
    - \sum_{j \in \{\mathrm{cons}\}_i} \frac{x_j y_j B_j F_{ji}}{e_{ij}}
\end{equation}

\begin{equation}
    (\#eq:growth)
    G_i = (1 - \dfrac{\sum_{j \in \{\mathrm{prod}\}} \alpha_{ij} B_j}{K_i})
\end{equation}

The primary producer biomass increase with a growth rate ($r_i$) of 1 and a
logistic growth (eq. \@ref(eq:growth)), growth being limited by intraspecific
($\alpha_{ii}$, set to 1), interspecific ($\alpha_{ij}$, set to 0.5) competition,
and carrying capacity ($K_i$, varying in the simulations). Primary producers
loses biomass by being eaten by consumers at a rate that depend on consumer
metabolic rates ($x_j$), attack rates ($y_j$, set to 8 @delmas_analysing_2019),
a functional response (F_{ji}), and assimilation efficiency ($e_{ij}$, set to
0.45 for herbivores and 0.85 for carnivores, @delmas_analysing_2019).

\begin{equation}
    (\#eq:cons)
        \frac{dB_i}{dt} =
        \sum_{j \in \{\mathrm{res}\}_i} x_i y_i B_k F_{ij}
        - \sum_{j \in \{\mathrm{cons}\}_i} \frac{x_j y_j B_j F_{ji}}{e_{ij}}
        - x_i B_i
\end{equation}

Consumers gain biomass by eating other species and lose biomass by being
consumed and by metabolic loses ($x_i$, eq. \@ref(eq:cons)). The functional
response (eq. \@ref(eq:holling)) of consumer feeding depends on the preference
for its preys ($\omega_{ij}$, set even across consumer preys) and
half-saturation rate ($B_0$, set to 0.5). The hill coefficient ($h$, set to 1.5)
determines the shape of the functional response (Holling's type II or III).

\begin{equation}
    (\#eq:holling)
    F_{ij} = \frac{\omega_{ij} B_j^h}
    {B_0^h + \sum_{k \in \{\mathrm{res}\}_i} \omega_{ik} B_k^h}
\end{equation}

We simulated the dynamics of the `r nfw` food-webs across a gradient of global carrying capacity (K,
range: `r k_range["min"]`-`r k_range["max"]`). The carrying capacity were
standardized according to the number of producers and interspecific competition
($K_i = \frac{1 + \alpha_{ij} (S - 1)}{S}K$) to prevent changes in productivity
due to system size [@ives_stability_2000; @loreau_species_2008]. We ran
simulations for 5000 timesteps. At the end of simulations, we removed dead
species and measured community biomass, species richness and food-web structure.
If the final community contained disconnected producers (i.e. without consumers)
or disconnected consumers (i.e. consumers without preys), we discarded them and
run the simulations again with the same parametrisation. The simulations were
done using the Julia package `EcologicalNetworksDynamics.jl`
[@lajaaiti_ecologicalnetworksdynamicsjl_2024]. Then we computed the community
and food-web metrics at the last timesteps and analyzed the data with the same
SEM than described above.


# References  {-}

<div id="refs"></div>

\newpage





