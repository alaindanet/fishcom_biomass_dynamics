---
title: "Biomass and species richness temporal trends drives the assembly and the disassembly of food-web in natural fish assemblages"
author: Alain Danet, Maud Mouchet, Loubna El Madouri, Elisa Thébault and Colin Fontaine (ordre non fixé)
date: \today 
output:
  bookdown::pdf_document2:
    fig_caption: true 
    keep_tex: true
    toc: true
fontsize: 12pt
header-includes:
   - \usepackage{natbib}
   - \usepackage{float}
   - \usepackage[table]{xcolor}
   - \usepackage{multirow}
   - \usepackage{booktabs}
   - \usepackage{makecell}
   - \usepackage{setspace}
   - \doublespacing
   - \usepackage{lineno}
   - \linenumbers
geometry: margin=2cm
bibliography: references.bib
number_sections: true
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  cache = FALSE,
  collapse = TRUE,
  comment = "#>",
  #fig.dim = c(7, 7),
  fig.fullwidth = TRUE,
  fig.show = "hold",
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  results = TRUE
)
```


```{r, results = FALSE}
library(drake)
library(tidyverse)
library(magrittr)
library(cowplot)
library(viridis)
library(kableExtra)
library(sf)
mypath <- rprojroot::find_package_root_file
source(mypath("R/variable_shortcut.R")) # Define your custom code as a bunch of functions.
source(mypath("R/misc.R"))
source_dir(get_mypath("R")) # Define your custom code as a bunch of functions.

mytheme <- theme_cowplot() +
background_grid()

theme_set(mytheme)
options(knitr.table.format = "latex")
```

```{r}
net_var_bm <- c("log_rich_std", "ct_ff", "w_trph_lvl_avg", "piel_bm",
      "piel_nind")
net_var_rich <- c("log_bm_std", "ct_ff", "w_trph_lvl_avg", "piel_bm",
      "piel_nind")
```

# Introduction

## community structure are dynamics and affect ecosystem functions 

Biodiversity affects ecosystem properties such as total biomass, productivity
and stability [@tilman_biodiversity_2014; @loreau_biodiversity_2001]. However,
current biodiversity is at risk, numerous studies reported dramatic declines of
population and community biomass [@ceballos_biological_2017;
@hallmann_more_2017; @albano_native_2021], as well as decrease in species
richness 
[@barnosky_has_2011; @newbold_global_2015]. Consequences of such trends on
various aspects of community structure are not well-known whereas numerous
ecological studies have shown that the different aspects of community structure
are tightly linked [REF].

The temporal trends of species richness and community biomass are indeed
predicted to affect community structure. The positive link between Biodiversity
and ecosystem functioning shown in experimental studies predict that loss and
gain of species richness should respectively result in loss and gain of
community biomass [@tilman_biodiversity_2014; @pennekamp_biodiversity_2018]. But
this relation is not always found in natural settings [@grace_integrative_2016;
@li_relationship_2018; @maureaud_biodiversityecosystem_2019]. Numerous studies
find relation between species richness and evenness, but their disagree on the
sign of the relationships [@soininen_relationship_2012; @ma_species_2005;
@maureaud_biodiversityecosystem_2019], highlighting the diversity of assembly
processes in ecological communities.

The distribution and the number of ecological interactions, i.e. the structure
of ecological networks, also covaries with species richness and community
biomass. In food-webs, connectance, which measures the degree of generalism in a
network, has been theoretically shown to positively scale with
community biomass [@thebault_food-web_2003]. Connectance has been also shown to
be negatively related to species richness in empirical food-webs
[@dunne_network_2006]. Trophic level has also been shown to be positively linked
to total biomass in theoretical models [@wang_biodiversity_2018]. All together,
these studies show that the different dimensions of network structure are 
closely linked. 

The links between the different component of community structure often come from
spatial gradient comparison. The space for time substitution allows to use the
studies mentioned above to predict how changes in species richness or community
biomass will in turn affect community and network structure. The hypothesis that
space can surrogate space is often implicitly made in ecological studies. This
method began to be widely used in the early 20th century to infer the temporal
succession of vegetation from space variations [@pickett_space-for-time_1989].
It supposes a homology between variations in space and in time i.e. that spatial
sequences corresponds to temporal sequences. This method have raised criticisms
[@damgaard_critique_2019], with studies showing analogous patterns in space and
time [@blois_space_2013] or not [@johnson_testing_2008;
@adler_contrasting_2007]. Spatial turnover of species composition, dispersal
limitation, disturbance and stochastic processes have been hypothesised to be
responsible for the failure of space for time substitution
[@adler_contrasting_2007; @blois_space_2013].

In this line, how community biomass and species richness temporal trends are
linked to temporal changes in food-web structure is still an open question, as
well as if space for time substitution works to infer consequences of species
richness and community biomass on food-web structure. The increasing
availability of ecological temporal series makes possible to assess those
questions.

Using a standardized monitoring of fish freshwater communities on the period
1995-2018, we assessed the relationships among temporal trends of food-web
structure, trends of community biomass and trends in species richness.  
Moreover, we tested if the those relationships differs between communities that
loosed or gained biomass/species richness across time, reflecting potential
difference between disassembly and assembly processes. We finally assessed if
spatial relationships display the same patterns as temporal ones, to assess
the validity of space for time substitution. 

# Methods

## Data selection

We selected the stations that have been monitored at least 10 times on the
1995-2018 period.

## Food-web inference 

Because we had few informations about trophic interactions between resources, we
selected only the fish-fish interactions in subsequent analysis.

## Food-web and community structure

We characterized food-webs by its connectance, describing the degree of
generalism in a network [@dunne_network_2006; @delmas_analysing_2019]. It is
computed as the ratio between the actual number of links and the number of
potential links ($C = \frac{L}{S(S-1)}$, with $L$ being the number of links and
$S$ the number of trophic species). We also computed the average trophic level,
weighted by the biomass of the trophic species. The trophic level of a trophic
species is computed recursively as 1 added to the mean trophic level of the
preys that it consumes.

We described community structure by its community biomass, species richness and
the evenness of the number of individual and the amount of biomass across
species. The evenness was quantified with the Pielou index, computed as the
Shannon diversity index divided by the number of species ($P = \frac{H'}{N}$,
with $H'$ being the Shannon diversity index and $N$ the number of species).

```{r}
loadd(slope_com_var_no_covar, st_mono_trends_stable_rich_bm)
```
```{r}
nb_st <- unique(slope_com_var_no_covar$station) %>% length
rm(slope_com_var_no_covar)
nb_st_rich_bm <- st_mono_trends_stable_rich_bm %>% length
```


## Classification of temporal trajectories

To characterize the links among the temporal trends of network and community
structure and the temporal trends of community biomass and species richness, we
characterized the temporal trajectories of network and community structure at
each site. We used a method based on second order polynomial which allows to
assess both the direction and the monotony of temporal trends
[@rigal_method_2020]. To avoid complex variations of biomass and species
richness, we selected the stations that displayed monotonic trends for these
variables, i.e. the ones for which the second order polynomial term was non
significant. Over the `r nb_st` stations, the selection procedure resulted in 
`r nb_st_rich_bm` for community biomass and species richness analysis.

There was a clear relationship between the size of the communities and their
temporal dynamics. Communities that displayed low community biomass at the
beginning of their monitoring tend to display increase in biomass through time
and reversely. There same the same pattern for species richness, with
communities that displayed high species richness at the beginning of their
monitoring tend to display decrease in species richness through time and
reversely.


## Spatial

In spatial analysis, we selected the same stations that were used for the
temporal analysis. We summarised temporal series of each stations by the median
value over time of each variable.
 
# Statistical analysis

## Temporal trends 

With the aim to test the relationship among the temporal dynamics of network
structure from one side and species richness and community biomass from another
side, we modelled the dynamics the temporal trends of food-web structure ($dN$)
in function of the temporal trends of community biomass ($dB$) and species
richness ($dR$).

$dN = dB + dR$

With:

  - $dN$: temporal trend of network structure and communities structure
  - $dB$: temporal trend of community (log) biomass
  - $dR$: temporal trend of (log) species richness 

In order to control for the uncertainties of the estimated temporal trends, each
temporal trend was weighted by the inverse of the product of the standard errors of the
estimated trends, i.e. slopes for the response and the explicative
variables.

## Spatial trends

Spatial gradient of food-web structure are partly driven by environmental gradients, so
we controlled relationships among community structure variables by two PCA axis
synthesizing respectively (1) stream size and (2) average temperature and
enrichment. Enrichment was characterized by the average Biological Oxygen
Demand [BOD, @mallin_factors_2006].
 
$N =  B + R + E_1 + E_2$

With:

  - $N$: median network structure and communities structure
  - $B$: median community biomass
  - $R$: median species richness 
  - $E_1$: PCA1 related to stream size
  - $E_2$: PCA2 related to average temperature and average BOD


The significativity of the effects were tested with ANOVA.  In order to be able
to compare the magnitude of the effects of community biomass and species
richness in both temporal and spatial models, we computed standardized slopes
($r_{\delta}$) and their associated standard errors.

$r_{\delta} = \beta\frac{s_x}{s_y}$

with $\beta$ being the unstandardised slope, $s_x$ and $s_y$ the standard
deviation of the explicative and response variable.

All the statistical models displayed low multicollinearity (VIF < 3, Table XX).
We visually inspected the residuals of the linear models (TODO).

# Results

```{r}
loadd(rsq_sp_mod, summary_table, sp_models, model_summary)

loadd(rsq_table_bm_rich_mono_stable_trends, sp_rsq_table_bm_rich_mono_stable_trends)
```

```{r}
rsq_piel_nind <- rsq_table_bm_rich_mono_stable_trends %>%
  filter(Response == "piel_nind") %>%
  .$R.squared %>%
  round(., 3)

rsq_tlvl <- rsq_table_bm_rich_mono_stable_trends %>%
  filter(Response == "w_trph_lvl_avg") %>%
  .$R.squared %>%
  round(., 3)

rsq_tlvl_sp <- sp_rsq_table_bm_rich_mono_stable_trends %>%
  filter(Response == "w_trph_lvl_avg") %>%
  .$Conditional %>%
  round(., 3)

rsq_piel_bm_sp <- sp_rsq_table_bm_rich_mono_stable_trends %>%
  filter(Response == "piel_bm") %>%
  .$Conditional %>%
  round(., 3)
```

Overall, we found high heterogeneity in the explicative power of statistical
models linking temporal dynamics of food-web structure and the one of community
biomass and species richness spanning from $R_{adj}^2= `r rsq_piel_nind`$ for
pielou of individual number to $R_{adj}^2= `r rsq_tlvl`$ for average trophic
level (Table \@ref(tab:rsq)). The spatial models were more performant, with
$R_{cond}^2$ varing from $`r rsq_tlvl_sp`$ to $`r rsq_piel_bm_sp`$ (Table
\@ref(tab:rsq-sp)).

---
#Overall, we found no significant effect of the temporal gain or losses of
#communinity biomass biomass and species richness on the relationship between the
#temporal trends of community structure and that of biomass and species richness
#(Table \@ref(tab:aov)).
---

## Relationships between temporal trends 

### Community structure and community biomass

```{r}
loadd(std_table_bm_rich_mono_stable_trends)
std <-
  std_table_bm_rich_mono_stable_trends %>%
  mutate(
    type = recode(type, spatial = "sp", temporal = "tps"),
    response = recode(response, log_bm_std = "bm", log_rich_std = "rich", ct_ff
      = "ct", piel_bm = "p_bm", piel_nind = "p_n", w_trph_lvl_avg = "tlvl"),
    term = recode(term, log_bm_std = "bm", log_rich_std = "rich")
    ) %>%
  rename(t = type, rep = response, sest = std_estimate) %>%
  mutate_at(vars(sest, stdse), ~round(.x, 2))
tps_bm <- std %>%
  filter(t == "tps", term == "bm")

tps_bm_sest <- tps_bm$sest
names(tps_bm_sest) <- tps_bm$rep
```
We found a significant positive relationship between the temporal trends of
community biomass from one side and species richness, average trophic level,
connectance from the other side (Fig. \@ref(fig:bm), Table \@ref(tab:aov),
respectively  $r_\delta = `r tps_bm_sest["rich"]`$, $`r tps_bm_sest["tlvl"]`$, 
$`r tps_bm_sest["ct"]`$), meaning that they temporally increased when the community
biomass temporally increased and respectively that they temporally decreased
when the community biomass decreased in time.

We found a significant negative relationship between the temporal trends of
community biomass and that of the pielou of biomass 
( $r_\delta = `r tps_bm_sest["p_bm"]`$), meaning that the eveness of biomass
across species
temporally increased when the community biomass
temporally decreased and respectively that the evenness of biomass temporally
decreased when the community biomass temporally increased (Fig. \@ref(fig:bm),
Table \@ref(tab:aov)). We also found the same pattern between the temporal
trends of community biomass and that of the pielou of individual number
($r_\delta = `r tps_bm_sest["p_n"]`$). 

---
#Overall, we did not find effect of assembly/disassembly on the relationships
#between the temporal trends of community structure and the one of community
#biomass. We also found that the median community biomass had no effect on the
#relationship between the temporal trends of community structure and the one of community
#biomass.
---

### Community structure and species richness 

```{r}
tps_r <- std %>%
  filter(t == "tps", term == "rich")

tps_r_sest <- tps_r$sest
names(tps_r_sest) <- tps_r$rep
```


The temporal trends of community biomass and pielou of biomass, had a positive
relationship with that of species richness (Fig. \@ref(fig:rich), Table
\@ref(tab:aov), $r_\delta = `r tps_r_sest["p_bm"]`$) while we did not find
significant relationships between the temporal trends of average trophic level,
connectance, pielou of individual number and the one of species richness (Fig.
\@ref(fig:rich), Table \@ref(tab:aov)).

---
#We also found that the relationship between the temporal trends of pielou of
#individual and connectance and that of species richness was dependant of the
#overall species richness of the community (Fig. \@ref(fig:rich), Table
#\@ref(tab:aov)), meaning that the relationship between temporal trends of
#pielou of individual and that of species richness was more positive as the
#community contained more species (Fig. \@ref(fig:rich), Table
#\@ref(tab:reg)). While the relationship between temporal trends of pielou
#of individual and that of species richness was more negative as the community
#contained more species (Fig. \@ref(fig:rich), Table \@ref(tab:reg)).
---

## Spatial relationships 

```{r}
sp_b <- std %>%
  filter(t == "sp", term == "bm")
sp_b_sest <- sp_b$sest
names(sp_b_sest) <- sp_b$rep

sp_r <- std %>%
  filter(t == "sp", term == "rich")
sp_r_sest <- sp_r$sest
names(sp_r_sest) <- sp_r$rep
```


### Community structure and community biomass

We found that species richness, connectance, average trophic level were
spatially positively related to community biomass (resp. 
$r_\delta = `r sp_b_sest["rich"]`$, $`r sp_b_sest["ct"]`$, 
$`r sp_b_sest["tlvl"]`$, Fig.
\@ref(fig:bm), Table \@ref(tab:aov-sp)) while the pielou of biomass was
negatively related to community biomass ($r_\delta = `r sp_b_sest["p_bm"]`$).
However, we found no spatial relation between the pielou of individual and
community biomass.

### Community structure and species richness 

Community biomass, the pielou of biomass and individual were
positively related to species richness (resp. 
$r_\delta = `r sp_r_sest["bm"]`$, $`r sp_r_sest["p_bm"]`$,
$`r sp_r_sest["p_n"]`$) while average
trophic level and connectance were negatively related to
species richness (resp. $r_\delta = `r sp_r_sest["tlvl"]`$, $`r sp_r_sest["ct"]`$,
Fig. \@ref(fig:rich), Table \@ref(tab:aov-sp)).

# Discussion

## Biomass temporal dynamics is linked to the top trophic level

We found that the temporal increase of the average trophic level was positively
linked to increase of community biomass in line with a previous model suggesting
that the presence of higher predator can lead to higher community biomass
[@wang_biodiversity_2018]. Increase of average trophic level can be associated
to either gain of biomass in the highest trophic level nor losses of biomass in
the lowest trophic. In our case, such gain or losses of average trophic level is
probably associated to the variations of the presence of large fishes. The
finding that the evenness of biomass, measured by the pielou, decreased through
time as community biomass decrease and reversely, meaning that biomass
distribution across species respectively become respectively less and more even
when community biomass decrease and increase. We also found that evenness
decreased temporally of number of individual when community biomass increased
temporally, confirming that the temporal trends of community biomass in our
study is linked to big individuals. It further indicates that temporal loss of
community biomass are linked with the loss of the higher trophic level.

We also found in space that evenness of biomass was positively related to
community while eveness of individual number had no relation. It constrasts with
previous studies which found a negative relationship between biomass and eveness
of individual in marine and plant communities [@drobner_relation_1998;
@maureaud_biodiversityecosystem_2019] or studies that found more even plant
communities in terms of individual number display higher community biomass
[@wilsey_biodiversity_2000].

We further found that the temporal trends of connectance was positively
linked to that one of community biomass, meaning that connectance increases through
time in a given site when community biomass increases through time and reversely.
This is in line with the fact that the fishes located at higher trophic level
also display a larger number of links as the size of the predation window
increases with the size of the fishes. This result is also in accordance with  
theoretical work showing that higher food-web connectance result in higher
community biomass [@thebault_food-web_2003].

##  Biomass and richness variation are not the same process 

To the difference with community biomass, the temporal trends of eveness of
biomass was positively related to the temporal trends of species
richness, meaning that as species richness temporally increase, the
distribution of biomass become more even, while temporal trends of eveness of
individual had no significant relationship with species richness. Those results
indicate that biomass trends are linked to few big individuals while richness
trends are linked to overall shift in dominance in communities.  

Surprinsingly, we found that the temporal trends of connectance was not related to
the one of species richness as found spatially in most empirical food-web
[@dunne_network_2006] and also in the present study. This result suggests that
the structure of food-webs might be not very sensitive to variation of species
richness and that species loss and gain concerns species of low trophic level,
which in turn does affect connectance very little. However, the relationship become
slightly negative for species poor communities. An explanation might be that
species-rich communities already contains a significant number of piscivores,
which have the most links whereas species poor communites contains few
piscivores.

## Temporal dynamics confirms space for time substitution BEF

Spatially and temporally, the species richness was positively linked to that of
community biomass. Spatially, this result is in accordance with numerous studies was
already found in streams [@woods_testing_2020; @danet_species_nodate] but also
in grasslands, salt marches and forests [@hector_plant_1999;
@tilman_biodiversity_2014; @wu_relationship_2015; @li_relationship_2018; but see
@grace_integrative_2016]. Therefore, our results confirm that BEF prediction
works also in time. The positive relationship of species richness on total
biomass might be due to resource use complementarity [@carey_determining_2011],
which is held by niche differentiation [@loreau_biodiversity_1998;
@loreau_partitioning_2001] or to the higher probability of getting high biomass
species with higher species richness [@loreau_biodiversity_2001].
 

---
#The temporal trend of the average trophic level had no relationship with the
#one of species richness. It is surprising because one can imagine that loss and
#gain of species would reveal assembly/disassembly mechanisms in terms of trophic
#structure. However, we found that when species richness increases, the
#distribution of biomass and individuals among species become more even in the
#community, meaning that dominance decrease.
---

## Space for time substitution does not always hold 

While space for time works for variation of community biomass, it is less clear
for the variation of species richness. Indeed, it was not the case for
connectance and average trophic level that were respectively weakly or not
linked to species richness in time whereas our result shows a strong negative
relation in space. This result is in line with other studies which found
mismatch between spatial and temporal patterns [@adler_contrasting_2007;
@johnson_testing_2008]. This mismatch is mainly due to the crucial assumptions
that variations in space will correspond to differences of assembly stages and
then reflect the assembly/disassembly trajectories in time of communities [@].

In contrast with a meta-analysis [@soininen_relationship_2012], we found that
the eveness of individual number is positively related to the one of species
richness in space in stream fish assemblages but found no relationship in time.

This result has profound implications for conservation. As more and more
studies report community biomass and richness trends [@hallmann_more_2017;
@ceballos_biological_2017], it is important to note that they might not be
equivalent in terms of consequences on the structure of the community. Further,
studies should investigate the temporal trends of several dimensions of
community structure simultaneously because it drives many aspects of ecosystem
functioning.

---
### Biomass and richness gains and losses are symmetric processes in terms of community structure
#
#We found no case in which gain or losses of biomass and richness lead to
#different relationship between the temporal dynamic of community structure and
#the one of biomass and species richness. We could have imagined that
#extinction/colonisation processes or immigration/extinction debt could have lead
to different relationships.
---

## Conclusion

Our study shows that richness and biomass temporal trends in natural fish
communities relate on different ecological processes, biomass temporal dynamics
being related to variation of highest trophic level while it is not the case for
species richness. Our work also suggests that space for time substitution may be
relevant to predict food-web community structure in case of biomass variation
but not for species richness variation. We look forward to next investigations
to see the generality of assembly rules in food-webs. There are crucial to
better understand the temporal dynamics of food-webs structure and then its
impact on ecosystem functioning. 

# References  {-}

<div id="refs"></div>

\newpage

# Figures {-}

```{r}
fig_bm_cap <- paste0(
  "Relationship between community structure and community biomass. Left panel
  displays the relationships between the temporal trends of community structure
  and the one of community biomass. Lines correspond to the predictions of the
  linear models while the points are colored according the median community
  biomass of the three first years of the given temporal series. The lines
  surrounding each point represent the standard error associated to the temporal
  trends. Right panel displays the
  spatial relationship between median community structure over time and the
  median community biomass over time."

)

fig_rich_cap <- paste0(
  "Relationship between community structure and species richness. Left panel
  displays the relationships between the temporal trends of community structure
  and the one of species richness. Lines correspond to the predictions of the
  linear models while the points are colored according the median species
  richness of the three first years of the given temporal series. The lines
  surrounding each point represent the standard error associated to the temporal
  trends. Right panel displays the spatial relationship between median community
  structure over time and the median species richness over time."

)
```

```{r}
loadd(sp_fig1_2_bm_rich_mono_stable_trends,
  pred_bm_rich_mono_stable_trends)

fig1_2 <- get_plot_rich_bm(
  predict_plot = pred_bm_rich_mono_stable_trends,
  get_list = TRUE,
  rm_legend = FALSE,
  bm_x = "log_bm_std",
  bm_y = c("ct_ff", "w_trph_lvl_avg", "piel_bm"), #, "piel_nind"
  rich_y = c("ct_ff", "w_trph_lvl_avg", "log_bm_std", "piel_bm"), #, "piel_nind"
  rich_x = "log_rich_std"
  )
p_bm <- fig1_2$bm
names(p_bm) <- c("ct_ff", "w_trph_lvl_avg", "piel_bm")
plot_grid(plotlist = p_bm)

p_sp_bm <- sp_fig1_2_bm_rich_mono_stable_trends$bm
names(p_sp_bm) <- c("log_rich_std", "ct_ff", "w_trph_lvl_avg",
  "piel_bm", "piel_nind")
```

```{r}
fig_bef_cap <- paste0(
  "Relationship between the temporal trends of community structure
  and the one of species richness. Lines correspond to the predictions of the
  linear models. The lines surrounding each point represent the standard error
  associated to the temporal trends."
)
```
```{r bef, fig.cap=fig_bef_cap}
fig1_2$rich$log_bm_std
```

```{r}
fig_bm_rich_cap <- paste0(
  "Relationship among the temporal trends of community structure
  and the one of species richness and community biomass. The lines
  surrounding each point represent the standard error associated to the temporal
  trends."
)
```
```{r bmr, fig.height = 12, fig.cap=fig_bm_rich_cap}
fig2 <- fig1_2
fig2$rich$log_bm_std <- NULL
plot_grid(
  plot_grid(plotlist = fig2$bm, nrow = 1),
  plot_grid(plotlist = fig2$rich, nrow = 1),
  nrow = 2
)
```


```{r bm, eval=FALSE, fig.height = 12, fig.cap=fig_bm_cap}
ti <- list()
for (
  i in c("log_rich_std", "w_trph_lvl_avg", "piel_bm", "piel_nind", "ct_ff")
  ) {
  ti[[i]] <- list(p_bm[[i]], p_sp_bm[[i]])
}


# Make the label on two lines
fig1 <- plot_grid(plotlist = c(ti[[1]], ti[[2]], ti[[3]], ti[[4]], ti[[5]]), ncol = 2)
fig1
```

```{r}
p_rich <- fig1_2$rich
p_sp_rich <- sp_fig1_2_bm_rich_mono_stable_trends$rich
```

```{r rich, eval=FALSE,fig.height = 12, fig.cap=fig_rich_cap}
trich <- list()
for (i in c("log_bm_std", "w_trph_lvl_avg",  "piel_bm", "piel_nind", "ct_ff")) {
  trich[[i]] <- list(p_rich[[i]], p_sp_rich[[i]])
}

# Make the label on two lines
fig2 <- plot_grid(
  plotlist = c(trich[[1]], trich[[2]], trich[[3]], trich[[4]], trich[[5]]),
  ncol = 2)
fig2
```

```{r}
std_cap <- paste0(
  "Standardized coefficients of the effects of community biomass and species
  richness on food-web structure for the temporal and spatial models. The lines
  display the standard errors."
)
```

```{r std, fig.cap=std_cap}
loadd(fig_std_coef)
fig_std_coef
```


\newpage

# Tables {-}

## Statistical models 

### Temporal

```{r}
loadd(pred_bm_rich_mono_stable_trends, anova_table_bm_rich_mono_stable_trends)
anova_table_bm_rich_mono_stable_trends %>%
  mutate(
    response = str_replace_all(response, var_replacement()),
    term = str_replace_all(term, var_replacement())
  ) %>%
  kable(.,
    booktabs = TRUE,
    row.names = FALSE,
    caption =
      paste0(
      "ANOVA results for the links between the temporal trends of
      community biomass and the temporal trends of the network structure."
    ),
  label = "aov"
  ) %>%
  kable_styling(latex_options = c("scale_down", "stripped")) %>%
  collapse_rows(columns = 1, valign = "top")
```

```{r}
loadd(reg_table_bm_rich_mono_stable_trends)
reg_table_bm_rich_mono_stable_trends %>%
  mutate(
    response = str_replace_all(response, var_replacement()),
    term = str_replace_all(term, var_replacement())
    ) %>%
kable(., booktabs = TRUE,
  row.names = FALSE,
  caption =
    paste0(
      "Regression coefficients for the linear models explaining the links
      between the temporal trends of community biomass and the temporal trends
      of the network structure."),
      label = "reg"
      ) %>%
  kable_styling(latex_options = c("scale_down", "striped")) %>%
  collapse_rows(columns = 1, valign = "top")
```



```{r}
loadd(rsq_table_bm_rich_mono_stable_trends)
rsq_table_bm_rich_mono_stable_trends %>%
  mutate(
    Response = str_replace_all(Response, var_replacement())
  ) %>%
  kable(., booktabs = TRUE,
    caption =
      paste0(
      "Marginal and conditional squared R for temporal models."),
  label = "rsq"
      ) %>% #
  kable_styling(latex_options = c("striped")) %>%
  collapse_rows(columns = 1, valign = "top")
```


### Spatial

```{r}
loadd(
  sp_anova_table_bm_rich_mono_stable_trends,
  sp_rsq_table_bm_rich_mono_stable_trends
)
```


```{r}
sp_anova_table_bm_rich_mono_stable_trends %>%
  mutate(
    response = str_replace_all(response, var_replacement()),
    term = str_replace_all(term, var_replacement()),
  ) %>%
  kable(.,
    booktabs = TRUE,
    row.names = FALSE,
    caption =
      paste0(
      "ANOVA results for the links among the spatial variation of community
      biomass and species richness and the one of network structure."),
  label = "aov-sp"
  ) %>%
  kable_styling(latex_options = c("scale_down", "striped")) %>%
  collapse_rows(columns = 1, valign = "top")
```

```{r}
sp_rsq_table_bm_rich_mono_stable_trends %>%
  mutate(
    Response = str_replace_all(Response, var_replacement())
  ) %>%
  kable(., booktabs = TRUE,
    caption =
      paste0(
      "Marginal and conditional squared R for spatial models."),
  label = "rsq-sp"
      ) %>% #
  kable_styling(latex_options = c("striped")) %>%
  collapse_rows(columns = 1, valign = "top")
```

